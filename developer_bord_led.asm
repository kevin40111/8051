	ORG	0
START:	MOV	R3,#14
	MOV	R2,#10
	MOV	R1,#78
	MOV	R5,#4
	MOV	R4,#EFH
	MOV	R0,#0

RESET:	MOV	B,#0
	MOV	R0,#0
	MOV	P2,#FFH
	MOV	P0,#FFH
	MOV	R3,#14
	MOV	R1,#78
	JMP	TODO

LOOP:	MOV	SP,#07
	MOV	R5,#4
	MOV	R4,#EFH
	MOV	R0,#0

	CALL	SCAN
TODO:	CALL	HW2

	CALL	DELAY
	CALL	DELAY
	CALL	DELAY
	CALL	DELAY
	JMP	LOOP


SCAN:	MOV	A,R4
	MOV	P1,A

	JNB	P1.0,KEYIN
	INC	R0

	JNB	P1.1,KEYIN
	INC	R0

	JNB	P1.2,KEYIN
	INC	R0

	JNB	P1.3,KEYIN
	INC	R0

	MOV	A,R4
	RL	A
	MOV	R4,A


	DJNZ	R5,SCAN
	JMP	KEYIN


KEYIN:	CALL	DELAY

	CJNE	R0,#16,INPUT
	MOV	R0,B
	JMP	COM
INPUT:	CJNE	R0,#10,IN
	JMP	STOP

BACK:	MOV	R0,B

IN:	MOV	B,R0


COM:
A0:	CJNE	R0,#5,A1
	JMP	RESET
A1:	CJNE	R0,#8,A2
	CALL	HW1
A2:	CJNE	R0,#9,A3
	CALL	HW3
A3:	JMP	TODO

STOP:
	MOV	R5,#4
	MOV	R4,#EFH
	MOV	R0,#0



STOP1:	MOV	A,R4
	MOV	P1,A
	JNB	P1.0,CASE
	INC	R0


	JNB	P1.1,CASE
	INC	R0
	CALL	DELAY

	JNB	P1.2,CASE
	INC	R0
	CALL	DELAY

	JNB	P1.3,CASE
	INC	R0
	CALL	DELAY

	MOV	A,R4
	RL	A
	MOV	R4,A

	CALL	HW2
	JMP	A

CASE:	CJNE	R0,#9,D
	JMP	ALIVE

D:	CJNE	R0,#8,C
	JMP	ALIVE

C:	CJNE	R0,#5,B
	JMP	RESET

B:	CJNE	R0,#4,A
ALIVE:	JMP	BACK

A:	DJNZ	R5,STOP1

	JMP	STOP



HW1:	MOV	A,R3
	MOV	DPTR,#LED1
	MOVC	A,@A+DPTR
	MOV	P2,A

	MOV	A,R3
	MOV	DPTR,#LED2
	MOVC	A,@A+DPTR
	MOV	P0,A

	MOV	A,R3
	JZ	SETR3
BACKR3:	DEC	R3
	RET



HW3:	MOV	A,R1
	MOV	DPTR,#L2D1
	MOVC	A,@A+DPTR
	MOV	P2,A

	MOV	A,R1
	MOV	DPTR,#L2D2
	MOVC	A,@A+DPTR
	MOV	P0,A

	MOV	A,R1
	JZ	SETR1
BACKR1:	DEC	R1
	RET


HW2:	MOV	P3,#FFH
	CALL	DELAY
	MOV	A,R2
	MOV	DPTR,#L7D
	MOVC	A,@A+DPTR
	MOV	P3,A

	MOV	A,R2
	JZ	SETR2
BACKR2:	DEC	R2
	RET


SETR1:	MOV	R1,#79
	JMP	BACKR1
SETR3:	MOV	R3,#15
	JMP	BACKR3
SETR2:	MOV	R2,#11
	JMP	BACKR2

LED1:	DB	11111110B
	DB	11111011B
	DB	11101111B
	DB	10111111B
	DB	11111101B
	DB	11110111B
	DB	11011111B
	DB	01111111B
	DB	11011111B
	DB	11110111B
	DB	11111101B
	DB	10111111B
	DB	11101111B
	DB	11111011B
	DB	11111110B

LED2:	DB	01111111B
	DB	11011111B
	DB	11110111B
	DB	11111101B
	DB	10111111B
	DB	11101111B
	DB	11111011B
	DB	11111110B
	DB	11111011B
	DB	11101111B
	DB	10111111B
	DB	11111101B
	DB	11110111B
	DB	11011111B
	DB	01111111B

L7D:	DB	00011001B
	DB	10011001B
	DB	00000010B
	DB	01001001B
	DB	00000010B
	DB	10011001B
	DB	00000010B
	DB	00000010B
	DB	10011111B
	DB	10011111B
	DB	11111111B

L2D1:	DB	00000000B	;82
	DB	11111111B	;81
	DB	00000000B	;80
	DB	11111111B	;79
	DB	00000000B	;78
	DB	11111111B	;77
	DB	00000000B	;73
	DB	00000000B	;72
	DB	00000010B	;71
	DB	00000011B	;70
	DB	00001001B	;69
	DB	00001011B	;68
	DB	00001110B	;67
	DB	00001111B	;66
	DB	00100111B	;65
	DB	00101101B	;64
	DB	00101111B	;63
	DB	00111011B	;62
	DB	00111110B	;61
	DB	00111111B	;60
	DB	10011111B	;59
	DB	10110111B	;58
	DB	10111101B	;57
	DB	10111111B	;56
	DB	11101111B	;55
	DB	11111011B	;54
	DB	11111110B	;53
	DB	11111111B	;52
	DB	01111111B	;51
	DB	11011111B	;50
	DB	11110111B	;49
	DB	11111101B	;48
	DB	11111111B	;47
	DB	10111111B	;46
	DB	11101111B	;45
	DB	11111011B	;44
	DB	11111110B	;43
	DB	11111111B	;42
	DB	11111111B	;41
	DB	01111111B	;40
	DB	11011111B	;39
	DB	11110111B	;38
	DB	11111101B	;37
	DB	11111111B	;36
	DB	11111111B	;35
	DB	10111111B	;34
	DB	11101111B	;33
	DB	11111011B	;32
	DB	11111110B	;31
	DB	11111111B	;30
	DB	11111111B	;29
	DB	11111111B	;28
	DB	01111111B	;27
	DB	11011111B	;26
	DB	11110111B	;25
	DB	11111101B	;24
	DB	11111111B	;23
	DB	11111111B	;22
	DB	11111111B	;21
	DB	10111111B	;20
	DB	11101111B	;19
	DB	11111011B	;18
	DB	11111110B	;17
	DB	11111111B	;16
	DB	11111111B	;15
	DB	11111111B	;14
	DB	11111111B	;13
	DB	01111111B	;12
	DB	11011111B	;11
	DB	11110111B	;10
	DB	11111101B	;9
	DB	11111111B	;8
	DB	11111111B	;7
	DB	11111111B	;6
	DB	11111111B	;5
	DB	10111111B	;4
	DB	11101111B	;3
	DB	11111011B	;2
	DB	11111110B	;1


L2D2:   DB	00000000B	;82
	DB	11111111B	;81
	DB	00000000B	;80
	DB	11111111B	;79
	DB	00000000B	;78
	DB	11111111B	;77
	DB	00000000B	;73
	DB	00000000B	;72
	DB	00000000B	;71
	DB	00000000B	;70
	DB	00000000B	;69
	DB	00000000B	;68
	DB	00000000B	;67
	DB	00000000B	;66
	DB	00000000B	;65
	DB	00000000B	;64
	DB	00000000B	;63
	DB	00000000B	;62
	DB	00000000B	;61
	DB	00000000B	;60
	DB	00000000B	;59
	DB	00000000B	;58
	DB	00000000B	;57
	DB	00000000B	;56
	DB	00000000B	;55
	DB	00000000B	;54
	DB	00000000B	;53
	DB	00000000B	;52
	DB	00000010B	;51
	DB	00000010B	;50
	DB	00000010B	;49
	DB	00000010B	;48
	DB	00000010B	;47
	DB	00000011B	;46
	DB	00000011B	;45
	DB	00000011B	;44
	DB	00000011B	;43
	DB	00000011B	;42
	DB	00001001B	;41
	DB	00001011B	;40
	DB	00001011B	;39
	DB	00001011B	;38
	DB	00001011B	;37
	DB	00001011B	;36
	DB	00001110B	;35
	DB	00001111B	;34
	DB	00001111B	;33
	DB	00001111B	;32
	DB	00001111B	;31
	DB	00001111B	;30
	DB	00100111B	;29
	DB	00101101B	;28
	DB	00101111B	;27
	DB	00101111B	;26
	DB	00101111B	;25
	DB	00101111B	;24
	DB	00101111B	;23
	DB	00111011B	;22
	DB	00111110B	;21
	DB	00111111B	;20
	DB	00111111B	;19
	DB	00111111B	;18
	DB	00111111B	;17
	DB	00111111B	;16
	DB	10011111B	;15
	DB	10110111B	;14
	DB	10111101B	;13
	DB	10111111B	;12
	DB	10111111B	;11
	DB	10111111B	;10
	DB	10111111B	;9
	DB	10111111B	;8
	DB	11101111B	;7
	DB	11111011B	;6
	DB	11111110B	;5
	DB	11111111B	;4
	DB	11111111B	;3
	DB	11111111B	;2
	DB	11111111B	;1
DELAY:
	MOV	R7,#200
D1:	MOV	R6,#250
	DJNZ	R6,$
	DJNZ	R7,D1
	RET
	END